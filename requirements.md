# 夜の予定自動ロックシステム 要件定義書

## 1. システム概要

### 1.1 システム名
- 夜の予定自動ロックシステム

### 1.2 目的
- Googleカレンダーの夜の予定を自動的に管理し、効率的な予定調整を実現する
- 飲み会予定の自動検出と時間帯の自動ブロックによる予定管理の効率化

### 1.3 対象ユーザー
- 個人のGoogleカレンダー利用者
- 夜の予定管理を効率化したいユーザー

## 2. 機能要件

### 2.1 予定の自動管理機能
#### 2.1.1 過去の予定管理
- 過去1週間の予定を自動的に削除
- 削除対象：「予定を確保」「🍺 予定あり」イベント

#### 2.1.2 将来の予約管理
- 未来1ヶ月の予約イベントをクリア
- クリア対象：「予定を確保」「🍺 予定あり」イベント

#### 2.1.3 新規予定追加
- 夜の予定（19時以降）がある日の自動ブロック
- ブロック時間帯：18:30-21:00
- 1ヶ月先までの予定を自動管理

### 2.2 飲み会予定自動検出機能
#### 2.2.1 キーワード検出
- 検出キーワード：
  - 飲、懇親、宴、パーティ、会食
  - 集まり、交流、親睦、合同、打ち上げ
  - ディナー、歓送迎、オフ会

#### 2.2.2 自動マーキング
- 検出した飲み会予定に🍺アイコンを自動付与
- 既存の🍺アイコンは重複付与を防止

#### 2.2.3 時間帯ブロック
- 飲み会予定後の時間帯（21:00-24:00）を自動ブロック
- 「🍺 予定あり」として予定を確保

## 3. 非機能要件

### 3.1 技術要件
- **プラットフォーム**: Google Apps Script
- **実行環境**: Google Calendar API
- **タイムゾーン**: Asia/Tokyo
- **実行頻度**: 手動実行（メニューから実行可能）

### 3.2 制約条件
- カレンダーIDの固定（特定のGoogleカレンダーのみ対応）
- 処理対象期間: 過去1週間から未来1ヶ月
- 飲み会検出キーワードの固定

### 3.3 エラーハンドリング
- エラーログの記録（Stackdriver）
- 例外処理の実装
- 処理結果のログ出力

## 4. ユーザーインターフェース

### 4.1 メニュー構成
- Googleスプレッドシートのカスタムメニュー
- 「予定管理」メニュー
  - 「手動実行」オプション

### 4.2 ログ出力
- 処理結果の詳細ログ
- エラー発生時のエラーメッセージ
- 処理件数の表示

## 5. セキュリティ要件

### 5.1 アクセス制御
- GoogleカレンダーAPIの認証が必要
- 特定のカレンダーIDのみアクセス可能

### 5.2 データ保護
- カレンダー情報の適切な管理
- 個人情報の保護

## 6. 運用要件

### 6.1 実行タイミング
- 手動実行による処理
- 必要に応じた即時実行

### 6.2 メンテナンス
- キーワードリストの更新
- エラー発生時の対応
- 定期的な動作確認 